<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="reservationns">

	<insert id="insert" parameterType="reservation">
		insert into reservation
		values( reservation_seq.nextval, #{id}, #{r_name}, #{email},
		#{r_tel}, TO_DATE(#{r_date} ,'YYYY-MM-DD HH24:MI'), 'n', #{brand}, #{c_name}, #{find_city}, #{find_gu}, #{find_center} )
	</insert>
	
	<select id="list" parameterType="reservation" resultType="reservation">
		select * from reservation where id = #{id} and r_del = 'n'
	</select>
	
	<update id="delete" parameterType="reservation">
		update reservation set r_del = 'y' where rno = #{rno}
	</update>
	
	<select id="adminGetTotal" resultType="integer">
		select count(*) from reservation
	</select>
	
	<select id="adminReservationList" parameterType="reservation" resultType="reservation">
		select * from
		( select rowNum rn, a.* from ( select * from reservation
		
		<where>
			<if test="keyword!=null and keyword!=''" >
				${search} like '%'||#{keyword}||'%'
			</if>
		</where>
		order by rno
		desc ) a)
		where rn between #{startRow} and #{endRow}
	</select>
	
	<update id="adminDelete" parameterType="reservation">
		update reservation set r_del =
		#{r_del}
		where rno = #{rno}
	</update>

</mapper>